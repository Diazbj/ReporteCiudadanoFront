<!-- En index.html -->
<link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
<script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
<div class="container">
  <h2>Crear nuevo reporte</h2>

  <form [formGroup]="reporteForm" (ngSubmit)="formCrearReporte()">
    <div class="form-group">
      <label for="titulo">Título:</label>
      <input type="text" id="titulo" formControlName="titulo" class="form-control" />
    </div>

    <div class="form-group">
      <label for="descripcion">Descripción:</label>
      <textarea id="descripcion" formControlName="descripcion" class="form-control"></textarea>
    </div>

    <div class="form-group">
      <label for="ciudad">Ciudad:</label>
      <input type="text" id="ciudad" formControlName="ciudad" class="form-control" />
    </div>

    <div class="form-group">
      <label for="categoria">Categoría:</label>
      <select id="categoria" formControlName="categoria" class="form-select">
        <option *ngFor="let categoria of categoria" [value]="categoria.id">
          {{ categoria.nombre }}
        </option>
      </select>
    </div>

    <div class="form-group">
      <label for="imagenes">Imágenes:</label>
      <input type="file" id="imagenes" multiple (change)="onFileSelected($event)" class="form-control" />
    </div>

    <div class="form-group">
      <label>Selecciona ubicación en el mapa:</label>
      <div id="mapa" style="height: 400px; width: 100%; margin-bottom: 10px;"></div>
      <p *ngIf="ubicacionSeleccionada">
        Ubicación seleccionada: <strong>{{ ubicacionSeleccionada.latitud }}, {{ ubicacionSeleccionada.longitud
          }}</strong>
      </p>
      <p *ngIf="!ubicacionSeleccionada" class="text-danger">Haz clic en el mapa para seleccionar una ubicación.</p>
    </div>

    <button type="submit" class="btn btn-primary" [disabled]="reporteForm.invalid || !ubicacionSeleccionada">
      Crear Reporte
    </button>

    <button type="button" class="btn btn-secondary" (click)="goToInicio()">Cancelar</button>
  </form>
</div>